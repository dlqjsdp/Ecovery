<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">

<head th:with="pageTitle='무료나눔'">
    <title>무료나눔</title>
    <th:block layout:fragment="css">
        <!-- 추가 CSS (필요시만) -->
        <link rel="stylesheet" th:href="@{/css/freesharing.css}">
    </th:block>
</head>
<body>
<!--<div class="hamburger" id="hamburger">-->
<!--    <span></span>-->
<!--    <span></span>-->
<!--    <span></span>-->
<!--</div>-->

<th:block layout:fragment="header" th:replace="~{fragments/header :: header}"></th:block>

<!-- Main Content -->
<div layout:fragment="content">
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="hero-content">
                <h1>🤝 무료나눔 커뮤니티</h1>
                <p>사용하지 않는 물건을 이웃과 나누며 자원 순환을 실현하세요</p>
                <!-- 통계 표시 영역 - 서버에서 전달받은 통계 데이터 -->
                <div class="hero-stats">
                    <div class="stat-item">
                        <span class="stat-number" id="todayCompleted">1,247</span>
                        <span class="stat-label">오늘 나눔 완료</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalShared">15,382</span>
                        <span class="stat-label">총 나눔 건수</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="activeMembers">8,941</span>
                        <span class="stat-label">활성 회원</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Filter and Actions -->
    <section class="filter-section">
        <div class="container">
            <div class="filter-header">
                <div class="filter-left">
                    <h2>우리 동네 나눔</h2>
                </div>
                <div class="filter-right">
                    <!-- 나눔 등록 버튼 - 로그인한 사용자만 표시 -->
                    <button class="btn btn-primary" id="addItemBtn">
                        <span>+</span> 나눔 등록
                    </button>
                    <!-- 로그인 안 한 사용자용 버튼 -->
                    <a href="/member/login" class="btn  btn-primary" id="loginRedirectBtn" style="display: none;">
                        <span>+</span> 로그인하여 나눔 등록
                    </a>
                </div>
            </div>

            <!-- 필터 컨트롤 영역 - 폼으로 감싸서 서버에 전송 -->
                <div class="filter-controls" id="filterControls">
                    <div class="filter-group">
                        <label>카테고리</label>
                        <select id="categoryFilter" name="category">
                            <option value="">전체</option>
                            <option value="title">제목</option>
                            <option value="region">지역</option>
                            <option value="content">내용</option>
                        </select>
                    </div>

                    <div class="search-group">
                        <input type="text" id="searchInput" name="keyword" placeholder="원하는 검색어를 검색하세요...">
                        <button type="button" class="search-btn" id="searchBtn">🔍</button>
                    </div>
                </div>
            </form>
        </div>
    </section>

    <!-- Items Grid -->
    <section class="items-section">
        <div class="container">
            <div class="items-header">
                <div class="items-count">
                    <!-- 검색 결과 개수 표시 -->
                    <span id="totalItems">총 0건</span>의 나눔 물건
                </div>
            </div>

            <!-- 나눔 아이템 그리드 -->
            <div class="items-grid" id="itemsGrid">
                <!-- JS가 이 안에 카드와 '결과 없음' 메시지를 동적으로 추가할 예정 -->
            </div>

            <!-- 더보기 버튼 (JS가 사용함) -->
            <div class="load-more">
                <button class="btn btn-secondary" id="loadMoreBtn">더 보기</button>
            </div>

            <!-- 페이지네이션 영역 (JS가 내부 버튼을 생성함) -->
            <div class="pagination" id="pagination"></div>
        </div>
    </section>


    <!-- Add Item Modal -->
    <div class="modal" id="addItemModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>나눔 물건 등록</h3>
                <button class="modal-close" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addItemForm">
                    <div class="form-group">
                        <label for="itemTitle">제목 *</label>
                        <input type="text" id="itemTitle" name="title" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemCategory">카테고리 *</label>
                        <select id="itemCategory" name="category" required>
                            <option value="">선택하세요</option>
                            <option value="furniture">가구</option>
                            <option value="appliances">가전</option>
                            <option value="accessory">잡화</option>
                            <option value="etc">기타</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemDescription">상세 설명</label>
                        <textarea id="itemDescription" rows="4" name="content" placeholder="물건의 상태, 사용 기간, 특징 등을 설명해주세요"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="regionGu">나눔 지역 (구)</label>
                        <input type="text" id="regionGu" name="regionGu" placeholder="예: 강남구">

                        <label for="regionDong">나눔 지역 (동)</label>
                        <input type="text" id="regionDong" name="regionDong" placeholder="예: 역삼동">
                    </div>
                    
                    <div class="form-group">
                        <label for="itemImages">사진 업로드</label>
                        <div class="upload-area" id="uploadArea">
                            <div class="upload-placeholder">
                                <span class="upload-icon">📷</span>
                                <p>사진을 드래그하거나 클릭하여 업로드하세요</p>
                                <p class="upload-limit">최대 5장까지 업로드 가능</p>
                            </div>
                            <input type="file" id="itemImages" multiple accept="image/*" style="display: none;">
                        </div>
                        <div class="image-preview" id="imagePreview"></div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="cancelBtn">취소</button>
                        <button type="button" class="btn btn-primary" id="submitBtn">등록하기</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Item Detail Modal -->
    <div class="modal" id="itemDetailModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="detailTitle">물건 상세정보</h3>
                <button class="modal-close" id="closeDetailModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-content" id="detailContent">
                    <!-- Content will be loaded by JavaScript -->
                </div>
            </div>
        </div>
    </div>
</div>
    <th:block layout:fragment="script">
        <!-- 추가 JS (필요시만) -->
        <script th:src="@{/js/freesharing.js}"></script>
    </th:block>

</body>
</html>